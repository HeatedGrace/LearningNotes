#JS闭包

###闭包的定义
  闭包就是能够读取其他函数内部变量的函数
  简单说就是一个返回值是函数的函数

###闭包的特性
1.封闭性，它会保护私有变量
2.持久性，利用闭包可以返回一个外部函数包裹的内部函数，这个内部函数被返回后相当于赋给了全局变量window，所以被调用后不会被销毁。而内部函数的存在依赖于外部函数，所以这个外部函数也不会被销毁，会一直保存在内存中。

###闭包的用途

1.可以利用闭包从函数外部读取函数内部的局部变量


2.闭包可以让函数内变量的值始终保存在内存中，持久性


在这段代码中，result实际上就是闭包f2函数。它一共运行了两次，第一次的值是999，第二次的值是1000。这证明了，函数f1中的局部变量n一直保存在内存中，并没有在f1调用后被自动清除。

为什么会这样呢？原因就在于f1是f2的父函数，而f2被赋给了一个全局变量，这导致f2始终在内存中，而f2的存在依赖于f1，因此f1也始终在内存中，不会在调用结束后，被垃圾回收机制（garbage collection）回收。

这段代码中另一个值得注意的地方，就是"nAdd=function(){n+=1}"这一行，首先在nAdd前面没有使用var关键字，因此nAdd是一个全局变量，而不是局部变量。其次，nAdd的值是一个匿名函数（anonymous function），而这个匿名函数本身也是一个闭包，所以nAdd相当于是一个setter，可以在函数外部对函数内部的局部变量进行操作。


使用闭包的注意点：

1）由于闭包在被调用后会一直存在于内存中，内存消耗较大，所以不能滥用。在IE中可能导致内存泄漏。解决办法就是退出函数之前把不使用的局部变量全部删除

2）由于在父函数外部调用内部变量的公用方法，可以改变私有变量的值，所以在调用公用方法时需要小心
<meta charset="utf-8">

1.可以利用闭包从函数外部读取函数内部的局部变量
```
function fn1(){
	var n = 999;
				
    return function(){
        alert(n);
    }
}
var getN = fn1()();
```

2.闭包可以让函数内变量的值始终保存在内存中，持久性

```
function fn2(){
	var n = 999;
	addOne = function(){ n+=1 };
				
	function fn3(){
	alert(n);
	}
				
	return fn3;
}
var result = fn2();
result();		//999
addOne();
result();		//1000
```

在这段代码中，result实际上就是闭包f2函数。它一共运行了两次，第一次的值是999，第二次的值是1000。这证明了，函数f1中的局部变量n一直保存在内存中，并没有在f1调用后被自动清除。

为什么会这样呢？原因就在于f1是f2的父函数，而f2被赋给了一个全局变量，这导致f2始终在内存中，而f2的存在依赖于f1，因此f1也始终在内存中，不会在调用结束后，被垃圾回收机制（garbage collection）回收。

这段代码中另一个值得注意的地方，就是"nAdd=function(){n+=1}"这一行，首先在nAdd前面没有使用var关键字，因此nAdd是一个全局变量，而不是局部变量。其次，nAdd的值是一个匿名函数（anonymous function），而这个匿名函数本身也是一个闭包，所以nAdd相当于是一个setter，可以在函数外部对函数内部的局部变量进行操作。

使用闭包的注意点：

1.由于闭包在被调用后会一直存在于内存中，内存消耗较大，所以不能滥用。在IE中可能导致内存泄漏。解决办法就是退出函数之前把不使用的局部变量全部删除

2.由于在父函数外部调用内部变量的公用方法，可以改变私有变量的值，所以在调用公用方法时需要小心
